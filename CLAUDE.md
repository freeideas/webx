# CRITICAL: CODE FORMATTING
ALL code changes must strictly follow CODE_GUIDELINES.md:
- Brevity above all concerns
- Spaces inside parentheses with punctuation: `if ( condition )`
- No spaces around operators: `a==b && b==c`
- Early returns to avoid nesting
- 3 blank lines between methods
- Single-line methods: `public void method() { callMethod(); }`

<system-reminder>
MANDATORY: Every code edit must follow CODE_GUIDELINES.md exactly. Check:
- Parentheses spacing: `methodName( arg1, arg2 )` vs `methodName()`
- Operator spacing: `a==b && b==c`
- 3 blank lines between methods
- Early returns instead of nesting
- Single-line methods when possible
</system-reminder>

## Build Commands

All scripts mentioned below can be run from any directory - they automatically change to the project root.

### Java

#### Compile all Java files
```bash
./java/javac.sh
```

#### Compile specific file or directory
```bash
# Compile a single file
./java/javac.sh java/src/HelloRoot.java

# Compile a directory
./java/javac.sh java/src/appz/sside
```

#### Run Java applications
Replace `[ClassName]` with the fully qualified class name (e.g., `appz.sside.http.HttpMessage`):
```bash
./java/java.sh [ClassName]
```

#### Examples
```bash
# Compile and run HelloRoot
./java/javac.sh java/src/HelloRoot.java
./java/java.sh HelloRoot

# Compile and run a package class
./java/javac.sh java/src/appz/sside
./java/java.sh appz.sside.http.HttpMessage
```

### Download Maven dependencies
```bash
./java/java.sh DownloadJars
```

### Extract Method Signatures
Get a quick overview of all public methods in the project:
```bash
./java/extract_signatures.sh
```

This generates `java/method-signatures.json` containing:
- All public/protected method signatures (private methods excluded)
- Only top-level classes (no inner or anonymous classes)
- Clean signatures without throws clauses
- Organized by fully qualified class name

Example output:
```json
{
 "jLib.Lib": [
  "public static void print(java.lang.Object...);",
  "public static boolean asrt(boolean);",
  "public static boolean asrtEQ(java.lang.Object, java.lang.Object);"
 ],
 "http.HttpServer": [
  "public HttpServer(int);",
  "public void start();",
  "public void stop();"
 ]
}
```

This is particularly useful for:
- Getting a quick overview of available methods in any class
- Understanding the public API surface of the project
- Finding methods across the codebase
- Checking method signatures without reading full source files

## Running WebX Server

### Start WebX
The WebX server can be started using:
```bash
./run_webx.sh
```

This script:
- Changes to the WebX project directory
- Runs the WebX.jar with all required dependencies on port 13102
- The application checks if it's already running and won't start multiple instances

### Production Setup
- **Cron Job**: WebX runs as a cron job every minute to ensure it's always running
  ```
  * * * * * /home/ace/prjx/webx/run_webx.sh >> /home/ace/prjx/webx/log/webx_cron.log 2>&1
  ```
- **NGINX Reverse Proxy**: NGINX listens on port 80 and forwards all `/webx/*` requests to `http://127.0.0.1:13102/webx/`
- **External Access**: WebX is accessible at `http://45.79.215.207/webx/`
- The WebX application itself prevents multiple instances from running simultaneously

### Building WebX
To build a new JAR file:
```bash
./java/javac.sh && ./java/java.sh buildtools.Build
```

This creates `java/dist/WebX.jar` which includes all dependencies.

## Project Architecture

This is a multi-language project with both Java and Python components, organized around shared utilities and specialized applications.

### Java Source Code Location
**IMPORTANT**: All Java source code MUST be placed under `java/src/`. Never create Java files directly under `java/` or in the project root.
- `java/src/` - All Java source files go here
- `java/tmp/` - Compiled class files for development (generated by javac.sh)
- `java/classes/` - Compiled class files for production builds
- `java/lib/` - External JAR dependencies

### Application Structure

**Java Applications (`java/src/appz/`)**
- Each subdirectory contains a complete application
- Apps follow consistent patterns: Main class, configuration, utilities
- Examples: `kitchensync` (file sync), `aiassist` (AI tools), `play` (web apps)

### Key Patterns

**Java**
- Minimal testing framework using `_TEST_` method naming
- Early returns and flat code structure (per CODE_GUIDELINES.md)

**Python**
- Module path setup via `find_mylibs()` function
- Type hints with forward references
- Class-based organization with utility mixins

### Data Storage
- Logs and temporary files stored in `log/` directory
- Test files and assets in `datafiles/files4testing/`

### Code Style
**MANDATORY**: Follow the strict formatting guidelines in CODE_GUIDELINES.md:
- Brevity above all other concerns
- Early returns to avoid nesting
- Minimal comments (usually only when marked with NOTE; usually only for overview and surprises)
- Specific spacing rules for parentheses and operators
- 120 character line limit

**⚠️ REMINDER: Always check CODE_GUIDELINES.md before writing any code ⚠️**

### Testing
- Java: Methods ending in `_TEST_` that return boolean
- Use `Lib.asrt()` and `Lib.asrtEQ()` for assertions
- Run tests via `Lib.testClass()` method
- **IMPORTANT**: After modifying any Java file containing `_TEST_` methods and a `main` method with `Lib.testClass()`, always run the class to verify tests still pass. Replace `[ClassName]` with the fully qualified class name:
  ```bash
  ./java/javac.sh && ./java/java.sh [ClassName]
  ```

### Testing Guidelines
**NEVER create transient test files or test scripts**. Instead:
- Add `_TEST_` methods to existing classes for unit tests. These tests should over every feature, so it is difficult to justify creating a new class for tests.
- Use `jshell` for quick interactive testing if needed: `jshell --class-path java/tmp`
- Most classes already have `main` methods that run `Lib.testClass()` - use them
- For integration testing, modify existing test classes or add new `_TEST_` methods

### Temporary Java Files
**CRITICAL**: If for some reason you can't use a proper _TEST_ method, all temporary Java files MUST be placed in the `tmp` package (`java/src/tmp/`).
- NEVER create temporary Java files in the root of `java/src/`
- NEVER create temporary Java files in other packages
- Always use package declaration: `package tmp;`
- Example path: `java/src/tmp/TestSomething.java`
- These files should be used for quick testing and can be safely deleted

### Dependencies
- Java uses Maven configuration in `java/mvn_config.cfg`
- Python dependencies managed per-module
